# Настройка изображений главного меню

## Обзор

Теперь ваш бот поддерживает отображение изображения главного меню во всех сообщениях! Изображение будет автоматически добавляться ко всем сообщениям бота, создавая единообразный и профессиональный интерфейс.

## Настройка

### 1. Добавьте изображение

Поместите ваше изображение в папку `app/data/images/`. Рекомендуемое название: `DuckNetMainMenu.png`

### 2. Настройка конфигурации

В файле `.env` (или переменных окружения) добавьте следующие настройки:

```env
# Включить/выключить изображения главного меню
SHOP_MAIN_MENU_IMAGE_ENABLED=true

# Название файла изображения
SHOP_MAIN_MENU_IMAGE_NAME=DuckNetMainMenu.png
```

### 3. Требования к изображению

- **Формат**: PNG, JPG, JPEG
- **Размер**: Рекомендуется не более 10 МБ
- **Разрешение**: Оптимально 512x512 или 1024x1024 пикселей
- **Соотношение сторон**: Квадратное или близкое к квадратному

## Как это работает

### Автоматическая интеграция

Система автоматически:
1. **Проверяет настройки** - включены ли изображения в конфигурации
2. **Проверяет наличие файла** - существует ли указанный файл изображения
3. **Отправляет с изображением** - если всё настроено, отправляет фото с подписью
4. **Fallback на текст** - если изображения нет или отключены, отправляет только текст

### Поддерживаемые роутеры

Изображения теперь поддерживаются во всех основных роутерах:
- ✅ **Главное меню** (`main_menu`)
- ✅ **Профиль пользователя** (`profile`) 
- ✅ **Подписка** (`subscription`)
- ✅ **Поддержка** (`support`)
- ✅ **Скачивание приложений** (`download`)
- ✅ **Реферальная система** (`referral`)

### Технические детали

Система использует новые утилиты в `app/bot/utils/messaging.py`:
- `send_message_with_image()` - для новых сообщений
- `edit_message_with_image()` - для редактирования существующих
- `answer_with_image()` - для ответов на сообщения
- `edit_callback_with_image()` - для callback query

## Устранение неполадок

### Изображение не отображается

1. **Проверьте настройки**:
   ```env
   SHOP_MAIN_MENU_IMAGE_ENABLED=true
   ```

2. **Проверьте путь к файлу**:
   - Файл должен быть в `app/data/images/`
   - Имя файла должно точно совпадать с `SHOP_MAIN_MENU_IMAGE_NAME`

3. **Проверьте формат файла**:
   - Поддерживаются: PNG, JPG, JPEG
   - Размер не более 10 МБ

### Медленная загрузка

- Если изображение слишком большое, рассмотрите его сжатие
- Оптимальный размер: 200-500 КБ

### Ошибки в логах

Система автоматически логирует ошибки с изображениями и делает fallback на текстовые сообщения.

## Примеры

### Включение изображений
```env
SHOP_MAIN_MENU_IMAGE_ENABLED=true
SHOP_MAIN_MENU_IMAGE_NAME=MyBotLogo.png
```

### Отключение изображений
```env
SHOP_MAIN_MENU_IMAGE_ENABLED=false
```

При отключении изображений бот будет работать как обычно, отправляя только текстовые сообщения.

## Кастомизация

Если вы хотите использовать разные изображения для разных разделов, вы можете:

1. Расширить конфигурацию для поддержки нескольких изображений
2. Создать дополнительные функции в `messaging.py`
3. Настроить логику выбора изображения в зависимости от раздела

---

**Примечание**: Все изменения совместимы с существующим кодом. Если изображения отключены или недоступны, бот продолжит работать в обычном текстовом режиме.
